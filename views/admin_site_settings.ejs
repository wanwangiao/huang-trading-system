<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç¶²ç«™åŸºæœ¬è¨­å®š - èª æ„é®®è”¬å¾Œå°</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Microsoft YaHei', Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      color: #333;
    }
    
    .header {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      padding: 20px 0;
      box-shadow: 0 2px 20px rgba(0,0,0,0.1);
      margin-bottom: 30px;
    }
    
    .container {
      max-width: 1000px;
      margin: 0 auto;
      padding: 0 20px;
    }
    
    h1 {
      text-align: center;
      color: #4a5568;
      font-size: 2.5em;
      margin-bottom: 10px;
    }
    
    .subtitle {
      text-align: center;
      color: #718096;
      font-size: 1.1em;
      margin-bottom: 20px;
    }
    
    .section {
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      padding: 30px;
      margin-bottom: 30px;
      box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
    }
    
    .section h2 {
      color: #2d3748;
      margin-bottom: 20px;
      font-size: 1.8em;
      border-bottom: 3px solid #4299e1;
      padding-bottom: 10px;
    }
    
    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
    }
    
    .form-group {
      margin-bottom: 20px;
    }
    
    .form-group.full-width {
      grid-column: span 2;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: bold;
      color: #4a5568;
    }
    
    .form-control {
      width: 100%;
      padding: 12px;
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      font-size: 1em;
      transition: border-color 0.3s ease;
    }
    
    .form-control:focus {
      outline: none;
      border-color: #4299e1;
    }
    
    .form-control textarea {
      min-height: 100px;
      resize: vertical;
    }
    
    .file-upload-area {
      border: 2px dashed #cbd5e0;
      border-radius: 8px;
      padding: 30px;
      text-align: center;
      transition: all 0.3s ease;
      cursor: pointer;
      background: rgba(247, 250, 252, 0.5);
    }
    
    .file-upload-area:hover {
      border-color: #4299e1;
      background: rgba(66, 153, 225, 0.05);
    }
    
    .file-upload-area.dragover {
      border-color: #38a169;
      background: rgba(56, 161, 105, 0.1);
    }
    
    .upload-icon {
      font-size: 3em;
      color: #cbd5e0;
      margin-bottom: 10px;
    }
    
    .upload-text {
      color: #718096;
      margin-bottom: 10px;
    }
    
    .current-image {
      margin-top: 15px;
      text-align: center;
    }
    
    .current-image img {
      max-width: 300px;
      max-height: 150px;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    
    .hours-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
    }
    
    .day-hours {
      background: #f7fafc;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      padding: 15px;
    }
    
    .day-name {
      font-weight: bold;
      color: #2d3748;
      margin-bottom: 10px;
    }
    
    .time-inputs {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .time-input {
      flex: 1;
      padding: 8px;
      border: 1px solid #cbd5e0;
      border-radius: 4px;
      font-size: 0.9em;
    }
    
    .closed-checkbox {
      display: flex;
      align-items: center;
      gap: 5px;
      margin-top: 10px;
    }
    
    .btn {
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      font-size: 1em;
      font-weight: bold;
      cursor: pointer;
      text-decoration: none;
      display: inline-block;
      transition: all 0.3s ease;
      margin: 5px;
    }
    
    .btn-primary { background: #4299e1; color: white; }
    .btn-success { background: #38a169; color: white; }
    .btn-warning { background: #d69e2e; color: white; }
    .btn-secondary { background: #718096; color: white; }
    
    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }
    
    .current-settings {
      background: #e6fffa;
      border: 1px solid #38b2ac;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
    }
    
    .current-settings h3 {
      color: #234e52;
      margin-bottom: 15px;
    }
    
    .setting-item {
      margin-bottom: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .setting-label {
      font-weight: 500;
      color: #2d3748;
    }
    
    .setting-value {
      color: #4a5568;
    }
    
    /* ğŸ“± æ‰‹æ©Ÿç«¯éŸ¿æ‡‰å¼å„ªåŒ– */
    @media (max-width: 768px) {
      .container {
        padding: 0 15px;
      }
      
      h1 {
        font-size: 2em;
      }
      
      .section {
        padding: 20px 15px;
        margin-bottom: 20px;
        border-radius: 12px;
      }
      
      .section h2 {
        font-size: 1.5em;
      }
      
      .form-row {
        grid-template-columns: 1fr;
        gap: 15px;
      }
      
      .hours-grid {
        grid-template-columns: 1fr;
        gap: 10px;
      }
      
      .day-hours {
        padding: 12px;
      }
      
      .time-inputs {
        gap: 8px;
      }
      
      .time-input {
        padding: 6px;
        font-size: 0.85em;
      }
      
      .btn {
        padding: 10px 20px;
        font-size: 0.9em;
        margin: 3px;
      }
      
      .file-upload-area {
        padding: 20px;
      }
      
      .upload-icon {
        font-size: 2.5em;
      }
      
      .current-image img {
        max-width: 250px;
        max-height: 125px;
      }
    }
    
    @media (max-width: 480px) {
      .container {
        padding: 0 10px;
      }
      
      h1 {
        font-size: 1.8em;
      }
      
      .section {
        padding: 15px 10px;
      }
      
      .section h2 {
        font-size: 1.3em;
      }
      
      .btn {
        width: 100%;
        margin: 2px 0;
      }
      
      .setting-item {
        flex-direction: column;
        align-items: flex-start;
        gap: 5px;
      }
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="container">
      <h1>âš™ï¸ ç¶²ç«™åŸºæœ¬è¨­å®š</h1>
      <p class="subtitle">è¨­å®šç¶²ç«™åç¨±ã€èªªæ˜ã€é¦–é æ©«æ’åœ–æª”å’Œç‡Ÿæ¥­æ™‚é–“</p>
    </div>
  </div>

  <div class="container">
    <!-- ç›®å‰è¨­å®šç‹€æ³ -->
    <div class="section">
      <h2>ğŸ“‹ ç›®å‰è¨­å®šç‹€æ³</h2>
      <div class="current-settings" id="currentSettings">
        <h3>è¼‰å…¥ä¸­...</h3>
      </div>
    </div>

    <!-- ç¶²ç«™åŸºæœ¬è³‡è¨Š -->
    <div class="section">
      <h2>ğŸª ç¶²ç«™åŸºæœ¬è³‡è¨Š</h2>
      
      <form id="basicInfoForm">
        <div class="form-row">
          <div class="form-group">
            <label>ç¶²ç«™åç¨±ï¼š</label>
            <input type="text" id="siteName" class="form-control" 
                   placeholder="ä¾‹å¦‚ï¼šèª æ„é®®è”¬" required>
          </div>
          
          <div class="form-group">
            <label>è¯çµ¡é›»è©±ï¼š</label>
            <input type="tel" id="contactPhone" class="form-control" 
                   placeholder="ä¾‹å¦‚ï¼š02-1234-5678">
          </div>
        </div>
        
        <div class="form-group full-width">
          <label>ç¶²ç«™èªªæ˜ï¼š</label>
          <textarea id="siteDescription" class="form-control" rows="3"
                    placeholder="ä¾‹å¦‚ï¼šæ–°é®®è”¬æœå¤–é€æœå‹™ï¼Œç•¶æ—¥ç¾æ¡é…é€åˆ°åºœ"></textarea>
        </div>
        
        <div class="form-group full-width">
          <label>æœå‹™åœ°å€ï¼š</label>
          <input type="text" id="serviceArea" class="form-control" 
                 placeholder="ä¾‹å¦‚ï¼šä¸‰å³½ã€åŒ—å¤§ç‰¹å€ã€é¶¯æ­Œã€æ¨¹æ—ã€åœŸåŸ">
        </div>
        
        <button type="submit" class="btn btn-success">ğŸ’¾ å„²å­˜åŸºæœ¬è³‡è¨Š</button>
      </form>
    </div>

    <!-- é¦–é æ©«æ’åœ–æª”è¨­å®š -->
    <div class="section">
      <h2>ğŸ–¼ï¸ é¦–é æ©«æ’åœ–æª”</h2>
      
      <div class="form-group">
        <label>ä¸Šå‚³æ©«æ’åœ–æª”ï¼š</label>
        <div class="file-upload-area" id="bannerUploadArea">
          <div class="upload-icon">ğŸ“·</div>
          <div class="upload-text">
            <strong>é»æ“Šé¸æ“‡æª”æ¡ˆ</strong> æˆ–æ‹–æ”¾åœ–æª”åˆ°æ­¤å€åŸŸ<br>
            <small>å»ºè­°å°ºå¯¸ï¼š1200x300pxï¼Œæ”¯æ´ JPGã€PNG æ ¼å¼</small>
          </div>
          <input type="file" id="bannerFile" accept="image/*" style="display: none;">
        </div>
        
        <div class="current-image" id="currentBannerImage">
          <!-- å‹•æ…‹é¡¯ç¤ºç›®å‰çš„æ©«æ’åœ–æª” -->
        </div>
      </div>
      
      <button type="button" class="btn btn-primary" onclick="uploadBannerImage()">ğŸš€ ä¸Šå‚³åœ–æª”</button>
      <button type="button" class="btn btn-warning" onclick="removeBannerImage()">ğŸ—‘ï¸ ç§»é™¤åœ–æª”</button>
    </div>

    <!-- ç‡Ÿæ¥­æ™‚é–“è¨­å®š -->
    <div class="section">
      <h2>ğŸ• ç‡Ÿæ¥­æ™‚é–“è¨­å®š</h2>
      
      <form id="businessHoursForm">
        <div class="hours-grid">
          <div class="day-hours">
            <div class="day-name">æ˜ŸæœŸä¸€</div>
            <div class="time-inputs">
              <input type="time" class="time-input" name="monday_open" value="06:00">
              <span>-</span>
              <input type="time" class="time-input" name="monday_close" value="13:00">
            </div>
            <div class="closed-checkbox">
              <input type="checkbox" name="monday_closed" id="monday_closed">
              <label for="monday_closed">å…¬ä¼‘</label>
            </div>
          </div>
          
          <div class="day-hours">
            <div class="day-name">æ˜ŸæœŸäºŒ</div>
            <div class="time-inputs">
              <input type="time" class="time-input" name="tuesday_open" value="06:00">
              <span>-</span>
              <input type="time" class="time-input" name="tuesday_close" value="13:00">
            </div>
            <div class="closed-checkbox">
              <input type="checkbox" name="tuesday_closed" id="tuesday_closed">
              <label for="tuesday_closed">å…¬ä¼‘</label>
            </div>
          </div>
          
          <div class="day-hours">
            <div class="day-name">æ˜ŸæœŸä¸‰</div>
            <div class="time-inputs">
              <input type="time" class="time-input" name="wednesday_open" value="06:00">
              <span>-</span>
              <input type="time" class="time-input" name="wednesday_close" value="13:00">
            </div>
            <div class="closed-checkbox">
              <input type="checkbox" name="wednesday_closed" id="wednesday_closed">
              <label for="wednesday_closed">å…¬ä¼‘</label>
            </div>
          </div>
          
          <div class="day-hours">
            <div class="day-name">æ˜ŸæœŸå››</div>
            <div class="time-inputs">
              <input type="time" class="time-input" name="thursday_open" value="06:00">
              <span>-</span>
              <input type="time" class="time-input" name="thursday_close" value="13:00">
            </div>
            <div class="closed-checkbox">
              <input type="checkbox" name="thursday_closed" id="thursday_closed">
              <label for="thursday_closed">å…¬ä¼‘</label>
            </div>
          </div>
          
          <div class="day-hours">
            <div class="day-name">æ˜ŸæœŸäº”</div>
            <div class="time-inputs">
              <input type="time" class="time-input" name="friday_open" value="06:00">
              <span>-</span>
              <input type="time" class="time-input" name="friday_close" value="13:00">
            </div>
            <div class="closed-checkbox">
              <input type="checkbox" name="friday_closed" id="friday_closed">
              <label for="friday_closed">å…¬ä¼‘</label>
            </div>
          </div>
          
          <div class="day-hours">
            <div class="day-name">æ˜ŸæœŸå…­</div>
            <div class="time-inputs">
              <input type="time" class="time-input" name="saturday_open" value="06:00">
              <span>-</span>
              <input type="time" class="time-input" name="saturday_close" value="13:00">
            </div>
            <div class="closed-checkbox">
              <input type="checkbox" name="saturday_closed" id="saturday_closed">
              <label for="saturday_closed">å…¬ä¼‘</label>
            </div>
          </div>
          
          <div class="day-hours">
            <div class="day-name">æ˜ŸæœŸæ—¥</div>
            <div class="time-inputs">
              <input type="time" class="time-input" name="sunday_open" value="06:00">
              <span>-</span>
              <input type="time" class="time-input" name="sunday_close" value="13:00">
            </div>
            <div class="closed-checkbox">
              <input type="checkbox" name="sunday_closed" id="sunday_closed" checked>
              <label for="sunday_closed">å…¬ä¼‘</label>
            </div>
          </div>
        </div>
        
        <div style="margin-top: 20px;">
          <button type="submit" class="btn btn-success">ğŸ’¾ å„²å­˜ç‡Ÿæ¥­æ™‚é–“</button>
          <button type="button" class="btn btn-warning" onclick="resetBusinessHours()">ğŸ”„ é‡ç½®ç‚ºé è¨­</button>
        </div>
      </form>
    </div>

    <!-- è¿”å›æŒ‰éˆ• -->
    <div class="section">
      <a href="/admin/dashboard" class="btn btn-secondary">â† è¿”å›å¾Œå°ä¸»é </a>
      <a href="/admin/order-management" class="btn btn-primary">ğŸ“‹ è¨‚å–®ç®¡ç†</a>
      <a href="/admin/bank-settings" class="btn btn-primary">ğŸ¦ éŠ€è¡Œè¨­å®š</a>
    </div>
  </div>

  <script>
    let currentBannerFile = null;

    // é é¢è¼‰å…¥æ™‚åˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', function() {
      loadCurrentSettings();
      setupFileUpload();
      setupBusinessHourHandlers();
    });

    // è¼‰å…¥ç›®å‰è¨­å®š
    async function loadCurrentSettings() {
      try {
        const response = await fetch('/api/admin/site-settings');
        const data = await response.json();
        
        const container = document.getElementById('currentSettings');
        
        if (data.success) {
          const settings = data.settings;
          
          container.innerHTML = `
            <h3>ğŸ“Š ç›®å‰è¨­å®šç¸½è¦½</h3>
            <div class="setting-item">
              <span class="setting-label">ç¶²ç«™åç¨±ï¼š</span>
              <span class="setting-value">${settings.siteName || 'æœªè¨­å®š'}</span>
            </div>
            <div class="setting-item">
              <span class="setting-label">è¯çµ¡é›»è©±ï¼š</span>
              <span class="setting-value">${settings.contactPhone || 'æœªè¨­å®š'}</span>
            </div>
            <div class="setting-item">
              <span class="setting-label">æœå‹™åœ°å€ï¼š</span>
              <span class="setting-value">${settings.serviceArea || 'æœªè¨­å®š'}</span>
            </div>
            <div class="setting-item">
              <span class="setting-label">æ©«æ’åœ–æª”ï¼š</span>
              <span class="setting-value">${settings.bannerImage ? 'å·²è¨­å®š' : 'æœªè¨­å®š'}</span>
            </div>
            <div class="setting-item">
              <span class="setting-label">ç‡Ÿæ¥­æ™‚é–“ï¼š</span>
              <span class="setting-value">${settings.businessHours ? 'å·²è¨­å®š' : 'ä½¿ç”¨é è¨­'}</span>
            </div>
          `;
          
          // å¡«å……è¡¨å–®
          if (settings.siteName) document.getElementById('siteName').value = settings.siteName;
          if (settings.contactPhone) document.getElementById('contactPhone').value = settings.contactPhone;
          if (settings.siteDescription) document.getElementById('siteDescription').value = settings.siteDescription;
          if (settings.serviceArea) document.getElementById('serviceArea').value = settings.serviceArea;
          
          // é¡¯ç¤ºç›®å‰æ©«æ’åœ–æª”
          if (settings.bannerImage) {
            document.getElementById('currentBannerImage').innerHTML = `
              <p style="margin-bottom: 10px; color: #38a169; font-weight: bold;">ç›®å‰æ©«æ’åœ–æª”ï¼š</p>
              <img src="${settings.bannerImage}" alt="ç›®å‰æ©«æ’åœ–æª”">
            `;
          }
          
          // è¼‰å…¥ç‡Ÿæ¥­æ™‚é–“
          if (settings.businessHours) {
            loadBusinessHours(settings.businessHours);
          }
          
        } else {
          container.innerHTML = `
            <h3>âš ï¸ è¼‰å…¥è¨­å®šå¤±æ•—</h3>
            <p>è«‹é‡æ–°æ•´ç†é é¢æˆ–æª¢æŸ¥ç¶²è·¯é€£ç·š</p>
          `;
        }
      } catch (error) {
        console.error('è¼‰å…¥è¨­å®šå¤±æ•—:', error);
        document.getElementById('currentSettings').innerHTML = `
          <h3>âŒ è¼‰å…¥éŒ¯èª¤</h3>
          <p>ç„¡æ³•è¼‰å…¥ç›®å‰è¨­å®šï¼Œè«‹ç¨å¾Œå†è©¦</p>
        `;
      }
    }

    // è¨­å®šæª”æ¡ˆä¸Šå‚³
    function setupFileUpload() {
      const uploadArea = document.getElementById('bannerUploadArea');
      const fileInput = document.getElementById('bannerFile');
      
      uploadArea.addEventListener('click', () => fileInput.click());
      
      uploadArea.addEventListener('dragover', (e) => {
        e.preventDefault();
        uploadArea.classList.add('dragover');
      });
      
      uploadArea.addEventListener('dragleave', () => {
        uploadArea.classList.remove('dragover');
      });
      
      uploadArea.addEventListener('drop', (e) => {
        e.preventDefault();
        uploadArea.classList.remove('dragover');
        
        const files = e.dataTransfer.files;
        if (files.length > 0) {
          handleFileSelect(files[0]);
        }
      });
      
      fileInput.addEventListener('change', (e) => {
        if (e.target.files.length > 0) {
          handleFileSelect(e.target.files[0]);
        }
      });
    }

    // è™•ç†æª”æ¡ˆé¸æ“‡
    function handleFileSelect(file) {
      if (!file.type.startsWith('image/')) {
        alert('è«‹é¸æ“‡åœ–ç‰‡æª”æ¡ˆ');
        return;
      }
      
      if (file.size > 5 * 1024 * 1024) {
        alert('æª”æ¡ˆå¤§å°ä¸èƒ½è¶…é 5MB');
        return;
      }
      
      currentBannerFile = file;
      
      // é è¦½åœ–ç‰‡
      const reader = new FileReader();
      reader.onload = function(e) {
        document.getElementById('currentBannerImage').innerHTML = `
          <p style="margin-bottom: 10px; color: #d69e2e; font-weight: bold;">é è¦½æ–°åœ–æª”ï¼ˆå°šæœªå„²å­˜ï¼‰ï¼š</p>
          <img src="${e.target.result}" alt="é è¦½åœ–æª”">
        `;
      };
      reader.readAsDataURL(file);
    }

    // ä¸Šå‚³æ©«æ’åœ–æª”
    async function uploadBannerImage() {
      if (!currentBannerFile) {
        alert('è«‹å…ˆé¸æ“‡åœ–æª”');
        return;
      }
      
      const formData = new FormData();
      formData.append('banner', currentBannerFile);
      
      try {
        const response = await fetch('/api/admin/upload-banner', {
          method: 'POST',
          body: formData
        });
        
        const result = await response.json();
        
        if (result.success) {
          alert('âœ… æ©«æ’åœ–æª”ä¸Šå‚³æˆåŠŸï¼');
          loadCurrentSettings();
          currentBannerFile = null;
        } else {
          alert('âŒ ä¸Šå‚³å¤±æ•—ï¼š' + result.message);
        }
      } catch (error) {
        alert('âŒ ä¸Šå‚³æ™‚ç™¼ç”ŸéŒ¯èª¤');
        console.error(error);
      }
    }

    // ç§»é™¤æ©«æ’åœ–æª”
    async function removeBannerImage() {
      if (!confirm('ç¢ºå®šè¦ç§»é™¤æ©«æ’åœ–æª”å—ï¼Ÿ')) {
        return;
      }
      
      try {
        const response = await fetch('/api/admin/remove-banner', {
          method: 'DELETE'
        });
        
        const result = await response.json();
        
        if (result.success) {
          alert('âœ… æ©«æ’åœ–æª”å·²ç§»é™¤');
          loadCurrentSettings();
        } else {
          alert('âŒ ç§»é™¤å¤±æ•—ï¼š' + result.message);
        }
      } catch (error) {
        alert('âŒ ç§»é™¤æ™‚ç™¼ç”ŸéŒ¯èª¤');
        console.error(error);
      }
    }

    // å„²å­˜åŸºæœ¬è³‡è¨Š
    document.getElementById('basicInfoForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      
      const formData = {
        siteName: document.getElementById('siteName').value,
        contactPhone: document.getElementById('contactPhone').value,
        siteDescription: document.getElementById('siteDescription').value,
        serviceArea: document.getElementById('serviceArea').value
      };
      
      try {
        const response = await fetch('/api/admin/site-settings/basic', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(formData)
        });
        
        const result = await response.json();
        
        if (result.success) {
          alert('âœ… åŸºæœ¬è³‡è¨Šå„²å­˜æˆåŠŸï¼');
          loadCurrentSettings();
        } else {
          alert('âŒ å„²å­˜å¤±æ•—ï¼š' + result.message);
        }
      } catch (error) {
        alert('âŒ å„²å­˜æ™‚ç™¼ç”ŸéŒ¯èª¤');
        console.error(error);
      }
    });

    // è¨­å®šç‡Ÿæ¥­æ™‚é–“è™•ç†
    function setupBusinessHourHandlers() {
      const checkboxes = document.querySelectorAll('input[type="checkbox"][name$="_closed"]');
      
      checkboxes.forEach(checkbox => {
        checkbox.addEventListener('change', function() {
          const day = this.name.replace('_closed', '');
          const openInput = document.querySelector(`input[name="${day}_open"]`);
          const closeInput = document.querySelector(`input[name="${day}_close"]`);
          
          if (this.checked) {
            openInput.disabled = true;
            closeInput.disabled = true;
            openInput.style.opacity = '0.5';
            closeInput.style.opacity = '0.5';
          } else {
            openInput.disabled = false;
            closeInput.disabled = false;
            openInput.style.opacity = '1';
            closeInput.style.opacity = '1';
          }
        });
        
        // åˆå§‹åŒ–ç‹€æ…‹
        checkbox.dispatchEvent(new Event('change'));
      });
    }

    // è¼‰å…¥ç‡Ÿæ¥­æ™‚é–“åˆ°è¡¨å–®
    function loadBusinessHours(businessHours) {
      const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'];
      
      days.forEach(day => {
        const dayData = businessHours[day];
        if (dayData) {
          document.querySelector(`input[name="${day}_open"]`).value = dayData.open || '06:00';
          document.querySelector(`input[name="${day}_close"]`).value = dayData.close || '13:00';
          document.querySelector(`input[name="${day}_closed"]`).checked = dayData.closed || false;
        }
      });
      
      // é‡æ–°è§¸ç™¼changeäº‹ä»¶ä»¥æ›´æ–°UIç‹€æ…‹
      setupBusinessHourHandlers();
    }

    // å„²å­˜ç‡Ÿæ¥­æ™‚é–“
    document.getElementById('businessHoursForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      
      const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'];
      const businessHours = {};
      
      days.forEach(day => {
        businessHours[day] = {
          open: document.querySelector(`input[name="${day}_open"]`).value,
          close: document.querySelector(`input[name="${day}_close"]`).value,
          closed: document.querySelector(`input[name="${day}_closed"]`).checked
        };
      });
      
      try {
        const response = await fetch('/api/admin/site-settings/hours', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ businessHours })
        });
        
        const result = await response.json();
        
        if (result.success) {
          alert('âœ… ç‡Ÿæ¥­æ™‚é–“å„²å­˜æˆåŠŸï¼');
          loadCurrentSettings();
        } else {
          alert('âŒ å„²å­˜å¤±æ•—ï¼š' + result.message);
        }
      } catch (error) {
        alert('âŒ å„²å­˜æ™‚ç™¼ç”ŸéŒ¯èª¤');
        console.error(error);
      }
    });

    // é‡ç½®ç‡Ÿæ¥­æ™‚é–“ç‚ºé è¨­
    function resetBusinessHours() {
      if (!confirm('ç¢ºå®šè¦é‡ç½®ç‡Ÿæ¥­æ™‚é–“ç‚ºé è¨­è¨­å®šå—ï¼Ÿ')) {
        return;
      }
      
      const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];
      
      days.forEach(day => {
        document.querySelector(`input[name="${day}_open"]`).value = '06:00';
        document.querySelector(`input[name="${day}_close"]`).value = '13:00';
        document.querySelector(`input[name="${day}_closed"]`).checked = false;
      });
      
      // æ˜ŸæœŸæ—¥è¨­ç‚ºå…¬ä¼‘
      document.querySelector('input[name="sunday_open"]').value = '06:00';
      document.querySelector('input[name="sunday_close"]').value = '13:00';
      document.querySelector('input[name="sunday_closed"]').checked = true;
      
      setupBusinessHourHandlers();
      
      alert('âœ… ç‡Ÿæ¥­æ™‚é–“å·²é‡ç½®ç‚ºé è¨­è¨­å®š');
    }
  </script>
</body>
</html>